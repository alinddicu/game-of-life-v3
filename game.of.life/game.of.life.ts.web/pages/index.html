<!DOCTYPE html>

<html lang="en">
<head>
	<meta charset="utf-8" />
	<title>Game of life</title>

	<script src="libs/linq.min.js"></script>
	<script src="libs/knockout-latest.js"></script>

	<script src="scripts/GoL/Logic/CellState.js"></script>
	<script src="scripts/GoL/Logic/Cell.js"></script>
	<script src="scripts/GoL/Logic/RectangularInfinite2DGrid.js"></script>
	<script src="scripts/GoL/Logic/Cycle.js"></script>

	<script src="scripts/GoL/Drawing/IGoLOptions.js"></script>
	<script src="scripts/GoL/Drawing/CellButton.js"></script>
	<script src="scripts/GoL/Drawing/Board.js"></script>
	<script src="scripts/GoL/Drawing/BoardLine.js"></script>
	<script src="scripts/GoL/Drawing/ParamsForm.js"></script>

	<script src="scripts/tests.js"></script>
	<script src="scripts/app.js"></script>

	<link rel="stylesheet" href="app.css" type="text/css" />
	<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

</head>
<body>

	<!--<i class="material-icons custom-color">fiber_manual_record</i>
	<i class="material-icons custom-color">file_copy</i>
	<i class="material-icons custom-color">insert_drive_file</i>
	<i class="material-icons custom-color">arrow_drop_down_circle</i>
	<i class="material-icons custom-color">archive</i>
	<i class="material-icons custom-color">arrow_upward</i>
	<i class="material-icons custom-color">arrow_downward</i>
	<i class="material-icons custom-color">arrow_drop_down</i>
	<i class="material-icons custom-color">arrow_drop_up</i>

	<i class="material-icons custom-color">save_alt</i>
	<i class="material-icons custom-color">publish</i>-->

	<div id="main-over-container">
		<div id="main-container">
			<div id="controls-over-container">
				<div id="controls-container">
					<button class="control-button" onclick="board.rewind();" title="Fast rewind"><i class="material-icons custom-color">fast_rewind</i></button>
					<button class="control-button" onclick="board.previousCycle();" title="Previous"><i class="material-icons custom-color">skip_previous</i></button>
					<button class="control-button" onclick="board.play();" title="Play">
						<!-- ko if: !board().isPlaying() --><i class="material-icons custom-color">play_circle_filled</i><!--/ko-->
						<!-- ko if: board().isPlaying() --><i class="material-icons custom-color">play_circle_outline</i><!--/ko-->
					</button>
					<button class="control-button" onclick="board.pause();" title="Pause">
						<!-- ko if: !board().isPausing() --><i class="material-icons custom-color">pause_circle_filled</i><!--/ko-->
						<!-- ko if: board().isPausing() --><i class="material-icons custom-color">pause_circle_outline</i><!--/ko-->
					</button>
					<button class="control-button" onclick="board.nextCycle();" title="Next"><i class="material-icons custom-color">skip_next</i></button>
					<button class="control-button" onclick="board.fastForward();" title="Fast forward"><i class="material-icons custom-color">fast_forward</i></button>
					<button class="control-button" onclick="board.stop();" title="Reset"><i class="material-icons custom-color">stop</i></button>
					<button class="control-button" onclick="showParams();" title="Parameters"><i class="material-icons custom-color">settings</i></button>
				</div>
				<!--ko if: isParamsVisible() -->
				<div id="params-container">
					<h2 id="gol-params-title">Game of life parameters</h2>
					<div class="form-line">
						<label for="cellsPerRow">Cells per row</label>
						<input id="cellsPerRow" type="number" value="12" min="10" max="100" />
					</div>
					<div class="form-line">
						<label for="cellSize">Cell size (px)</label>
						<input id="cellSize" type="number" value="50" min="10" max="100" />
					</div>
					<div class="form-line">
						<label for="normalMutationDelay">Normal mutation delay (ms)</label>
						<input id="normalMutationDelay" type="number" value="100" min="0" />
					</div>
					<div class="form-line">
						<label for="rapidMutationDelay">Rapid mutation delay (ms)</label>
						<input id="rapidMutationDelay" type="number" value="10" min="0" />
					</div>
					<div class="form-line">
						<label for="aliveCellColor">Alive cell color</label>
						<input id="aliveCellColor" type="text" value="#374785" />
					</div>
					<div class="form-line">
						<label for="deadCellColor">Dead cell color</label>
						<input id="deadCellColor" type="text" value="#a8d0e6" />
					</div>
					<div class="form-line">
						<label for="isShowCellsCoordinates">Show cells coordinates</label>
						<input id="isShowCellsCoordinates" type="checkbox" />
					</div>
					<div class="form-line init-button-container">
						<button id="init-button" onclick="init();"><i class="material-icons custom-color">done_outline</i></button>
					</div>
				</div>
				<!--/ko-->
			</div>
			<div id="board-container">
				<div data-bind="css: { 'board-disabled': board().isDisabled(), 'board-enabled': board().isEnabled()}">
					<table id="cells-table">
						<tbody data-bind="foreach: board().boardLines">
							<tr>
								<!-- ko foreach: buttonCells -->
								<td>
									<button class="cell-button"
											data-bind="style: { width: width + 'px', height: heigth + 'px', 'background-color': backColor() }, click: cellButtonClick">
										<!-- ko text: text --><!--/ko-->
									</button>
								</td>
								<!-- /ko -->
							</tr>
						</tbody>
					</table>
				</div>
			</div>
		</div>
	</div>
</body>
</html>

<script type="text/javascript">
	var params = new GoL.Drawing.ParamsForm();
	var board = params.init();

	var viewModel = {
		board: ko.observable(board),
		isParamsVisible: ko.observable(false)
	};
	ko.applyBindings(viewModel);

	function init() {
		board = params.init();
		board.initCellButtonsInSquare(params.options);
		viewModel.board(board);
		viewModel.isParamsVisible(false);
	}

	function showParams() {
		var currentValue = viewModel.isParamsVisible();
		viewModel.isParamsVisible(!currentValue);
		viewModel.board().setEnabled(currentValue);
	}
</script>